# Égalisation et égaliseurs

<!-- TODO: plus d'images -->

Un égaliseur est un outil permettant de modifier le timbre d’une source sonore. En d’autres termes, on modifie la réponse en fréquence d’un signal. On peut alors considérer qu’un égaliseur est un potentiomètre de volume évolué, permettant d’accentuer ou d’atténuer certaines zones du spectre.

## La nécessité d’égaliser

L’égaliseur est certainement l’outil de traitement audio le plus connu. On le retrouve dans nombre d’application et d’équipement grand public. On peut alors se demander ce qui explique cette présence, et la nécessité de son utilisation.

### Corriger des artefacts de prise de son

Nous avons discuté, dans la partie précédente, de l’influence de la distance du microphone à la source sur le rendu sonore de celle-ci. L’esthétique majoritaire est actuellement à la prise de son d’hyperproximité. Or, les microphones directifs vont amplifier le bas du spectre lorsqu’ils sont placés à quelques centimètres (et moins) d’une source sonore. Voilà un premier artefact que l’on sera fréquemment amené à corriger par un traitement d’égalisation.

Cependant, on peut se demander alors pourquoi ne pas simplement reculer le microphone. Lorsque l’on cherche à réduire au maximum la contribution de l’acoustique environnante, ou à réaliser un « zoom » sonore sur un instrument, cette option n’est pas toujours envisageable.

### Réduire les problèmes de masquage

Comme nous l’avons déjà vu, le dispositif d’écoute traditionnel est le système stéréophonique. Ce système est cependant très limitant. En effet, nous avons à faire passer un grand nombre d’informations sur peu d’enceintes (seulement deux). On découvre alors des problèmes de masquage, où des sources sonores produisant leurs énergies dans des zones du spectre similaires auront tendance à se « brouiller ». On utilise alors un égaliseur pour créer une différentiation de timbre suffisante pour rendre les sources plus intelligibles.

### Une question de couleur

On choisit aussi d’égaliser des sources pour des raisons esthétiques. On bascule alors dans un traitement d’effet. Ici, il n’y a pas de justification technique, mais seulement la question du plaisir d’écoute, ou mieux, de la narration.

## Les types d’égaliseurs

Les égaliseurs ont une longue histoire que nous n’aborderons pas en détail. Rappelons simplement que les premiers égaliseurs ne permettaient souvent pas d’ajuster la zone du spectre à traiter. On appelle alors égaliseur **paramétrique** un égaliseur que l’on peut paramétrer. Ces derniers ont généralement trois réglages, la **fréquence de coupure**, le **facteur de qualité** et le **gain**.

+ La fréquence de coupure ajuste l’emplacement du spectre à traiter.
+ Le facteur de qualité (appelé aussi Q) définit la sélectivité du traitement. Plus le Q est grand, plus le filtre sera sélectif. Au contraire, plus le Q sera faible, plus le traitement affectera les fréquences environnantes.
+ Le gain définit le niveau de correction appliqué, en décibel.

:::{.callout-tip}
Le facteur de qualité est parfois appelé bande passante. Plus le facteur de qualité est grand, plus la bande passante est étroite, et vice versa.

En mixage, on préfère généralement des filtres peu sélectifs.
:::

Parfois, il est possible de changer l’ordre d’un filtre. Plus son ordre est élevé, plus la zone de transition entre la zone de spectre traitée et celle laissée intacte est raide.

On trouve généralement quatre formes principales de filtres :

+ La forme en cloche (*bell/peak filter*). Elle n’augmente ou ne réduit qu’une certaine partie du spectre centrée autour de la fréquence définie.
+ Les filtres en plateau (*shelf filter*). Il amplifie ou coupe tout ce qui se trouve au-dessus (haut) ou au-dessous (bas) de la fréquence choisie.
+ Le passe-bas (*lowpass/hicut*). Ne laisse passer que les fréquences inférieures à la fréquence réglée.
+ Le passe-haut (*hipass/lowcut*). Ne laisse passer que les fréquences supérieures à la fréquence définie.

## Un aperçu du fonctionnement des filtres numériques

Sans entrer dans les détails du traitement numérique du signal, il existe deux grands types de filtres : les filtres à réponse impulsionnelle finie et ceux à réponse impulsionnelle infinie. Clarifions ce point.

On entend généralement parler de « réponse impulsionnelle » lorsque l’on parle de réverbération. Dans ce contexte, une réponse impulsionnelle est la réaction d’une pièce spécifique à une impulsion. En d’autres termes, si vous frappez des mains dans une cathédrale et que vous enregistrez la réaction de l’espace à ce signal, vous obtiendrez une réponse impulsionnelle, qui n’est en fait qu’un enregistrement audio.

Si nous pouvions taper des mains à l’intérieur d’un filtre numérique et enregistrer sa sortie, nous obtiendrions également une réponse impulsionnelle. En traitement du signal, on utilise un signal très particulier à la place, appelé impulsion de Dirac.

Un Dirac est une impulsion aussi courte que possible. En pratique, on peut imaginer un fichier audio rempli de zéros, à l’exception d’un échantillon qui prend la valeur maximale admissible.

Lorsque l’on soumet un filtre à une impulsion de Dirac, on obtient en sortie du filtre sa réponse impulsionnelle. Cette seule réponse permet de caractériser l’ensemble du système.

Un filtre à réponse impulsionnelle infinie possède la propriété d’être applicable en temps réel sur le signal, au mépris d’une certaine altération de la phase du signal. Un filtre à réponse impulsionnelle finie prend généralement la forme d’un filtre à phase linéaire. Ainsi, la phase du signal est préservée, au mépris d’une latence importante ajoutée au signal.

:::{.callout-important}
Les filtres analogiques sont toujours des filtres IIR.
:::

## Les égaliseurs à phase linéaire

:::{layout-ncol="2"}
![Magnétude et phase d’un filtre IIR](../_resources/bitmap/eq/Capture%20d%E2%80%99e%CC%81cran%202023-01-19%20a%CC%80%2015.51.19.png)

![Magnitude et phase d’un filtre FIR](../_resources/bitmap/eq/Capture%20d%E2%80%99e%CC%81cran%202023-01-19%20a%CC%80%2015.54.22.png)
:::

Maintenant que nous savons que les filtres IIR analogiques et numériques introduisent un déphasage sur le signal, il est tentant de systématiquement utiliser un filtre à phase linéaire. Malheureusement, dans le monde de la physique, tout a un certain prix.

Il est vrai que les égaliseurs de phase linéaires ne modifient pas la relation de phase entre les microphones, mais ils posent deux problèmes majeurs. Le premier est qu’ils ajoutent énormément de latence. Ce n’est pas toujours un problème lors du mixage, mais si cet égaliseur doit être utilisé dans une console de mixage pour le live, ou sur un réseau de casques, cette conséquence n’est pas acceptable. 

De plus, les égaliseurs à phase linéaire ont également la très mauvaise habitude de créer un effet de *pre-ringing*. Avant d’éclaircir cette notion de « pre-ringing », admettons, tout d’abord, que tous les filtres audio ont un effet **post-ringing**. Nous nous souvenons qu’un filtre, soumis à une impulsion, produit une réponse impulsionnelle. On peut dire qu’en quelque sorte, le filtre « oscille » pendant un certain temps. Le « post-ringing » n’est pas un problème en soi, c’est là, la façon dont le filtrage fonctionne. Il n’est pas vraiment audible non plus, car il est masqué par le signal d’entrée.

Le préfiltrage, quant à lui, est beaucoup plus audible, car il se produit **avant** l’apparition du signal d’entrée. À ce stade, vous vous grattez peut-être la tête en pensant que le filtrage est une question de voyage dans le temps. Il est bien sûr impossible de prévoir la réponse d’un traitement avant sa stimulation, par contre, il nous est possible de retarder le signal pour rendre ce fonctionnement possible. C’est donc pour cela que les filtres à phase linéaire rajoutent une latence non négligeable sur le signal, afin de nous faire entendre les conséquences du filtre **avant** le signal traité. Et surtout, grâce à la compensation de retard de nos DAW, toutes nos pistes restent synchronisées.

:::{.callout-tip}
Les filtres qui génèrent un contenu avant le signal d’entrée ont une existence mathématique, mais pas physique. On dit qu’ils sont non causaux (parce que les effets précèdent les causes).
:::

Le *pre-ringing* génère un effet comparable à un effet « d’inversion » et lisse les transitoires. Si le filtre travaille dans les basses fréquences, le *pre-ringing* augmente. Pour réduire ce phénomène, il faut utiliser une réponse impulsionnelle plus longue, et donc augmenter la latence.

## Les filtres analogiques et leurs transpositions numériques

De nombreux outils (plug-ins) de mixages se vantent d’être des simulations numériques d’un équivalent analogique. Investiguons rapidement ce sujet.

Les filtres analogiques, comme dit plus haut, sont nécessairement des filtres IIR. Il existe donc une littérature très dense sur la réalisation de filtre analogique, la plupart reposant sur l’utilisation de fonctions mathématiques dites « polynomiales » (Butterworth, Bessel, Chebychev, etc.).

Tout se savoir précède l’ère du numérique. Il est donc naturel que la conception de filtres IIR en numérique s’appuie sur la conception de filtres analogiques. La réelle difficulté consiste à passer le filtrage du domaine analogique au domaine numérique.

:::{.callout-note}
Pour les lectrices et lecteurs les plus courageux, les principales stratégies d’adaptation d’un filtre analogique au domaine numérique sont l’utilisation de *la transformée bilinéaire*, *l’invariance impulsionnelle* et la *transformée par correspondance en Z*
:::

Cependant, il s’agit d’un sujet bien connu et bien documenté. Il faut donc retenir qu’une grande majorité (tous ?) des égaliseurs audio numérique exploitent des modélisations de filtres analogiques. Leur adaptation au domaine numérique est aujourd’hui une trivialité.